:: Commander Keen function structure
:: K7 Engine Build 12 (Under construction)
:: Last updated 10-9-2001


K7.BAS
  InitPAKLib
  AllocXMS
    (ErrorHandlerSub)
  InitEngine
    (ErrorHandlerSub)
  InitMenu
    (ErrorHandlerSub)
  InitScoreboard
  InitItems
    ClearSprites
  InitWeapons
  InitEnemies
  InitSound
    LoadSounds
      DebugLog
    (ErrorHandlerSub)
  LoadTiles
    MountPAK
    LoadArtFile
      LoadFromPAK
        PAKFilename
        PAKFileOffset
        PAKFileLength
      (DebugLog)
      (ErrorHandlerSub)
    SetTileType
    SetTileType2
    SetSlopeMask
    SetAnmLength
    SetAnmDelay
    (ErrorHandlerSub)
  LoadLevel
    LoadMap
      LoadMusic
        PlayMusic
      SetSwitchTag
      UpdateClipPoints
      ClearSprites
      LoadItems
        (DebugLog)
      LoadEnemies
        AssignEnemyFrame
        (DebugLog)
      LoadPortals
        (DebugLog)
      LoadPlatforms
      (ErrorHandlerSub)
    (DebugLog)
    (ErrorHandlerSub)
  SetPalette
  Intro
    PutTile
  MainLoop
    DoTimers
    DoInput
      MovePlayer
      ClimbUp
        TileType
        Map
      CheckSwitch
        SwitchTag
        PlaySound
      CheckTeleport
        (UpdateClipPoints)
      CheckClimb
      ClimbDown
        (TileType)
        (Map)
      TogglePogo
      SpawnPlayerShot
        SetShootingFrame
        (PlaySound)
      HandleMenu
        NewGame
          (LoadLevel)
        SaveGame
        LoadGame
    DoPhysics
      HandlePogoStick
        (PlaySound)
      CheckOnGround
        SlopeHeight
          SlopeMask
          MapFG
          (Map)
        (Map)
        (MapFG)
        (TileType)
        (UpdateClipPoints)
      ClipPlayerToMap
        HitPoint
          TileType2
          (TileType)
          (Map)
          (MapFG)
        HitWall
          (PlaySound)
        HitSlope
          (SlopeHeight)
        (PlaySound)
        (UpdateClipPoints)
      CheckJumpHeight
      (UpdateClipPoints)
    DoSprites
      TouchSprite
      KillPlayer
        (PlaySound)
    DoItems
      TouchItem
      AddSprite
      (PlaySound)
    DoShots
      ShotCollide
        (TileType)
        (Map)
        (MapFG)
        (SlopeHeight)
      KillShot
        (AddSprite)
        (ShotInRange)
        (PlaySound)
      ShotEnemy
      KillEnemy
        (AddSprite)
      KillShot
        (AddSprite)
        (ShotInRange)
        (PlaySound)
      ShotInRange
    HandleLifts
      --construction--
    HandleEnemies
      EnemyPhysics
        EnemyOnGround
          (TileType)
          (Map)
        EnemyClipPoints
        EnemyHitPoint
          (TileType)
          (Map)
          (MapFG)
        EnemyHitWall
          (EnemyClipPoints)
        EnemyHitSlope
          (SlopeHeight)
          (EnemyClipPoints)
      EnemyAI
        SlugAI
          EnemyInRange
          TouchPlayer
          (KillPlayer)
          (AddSprite)
          (PlaySound)
          (TileType)
          (Map)
        MushroomAI
          (EnemyInRange)
          (PlaySound)
          (TouchPlayer)
          (KillPlayer)
      DoEnemyFrame
        SlugFrames
        MushroomFrames
    PlayerState
      DoPlayerFrame
        MovingFrames
        SwitchingFrames
        DyingFrames
        TeleportingFrames
        ClimbingFrames
        PogoFrames
        ShootingFrames
      (LoadLevel)
    DoCamera
    DrawScreen
      AnmLength
      AnmDelay
      PutSprite
      AnmLength
      AnmDelay
      PutSprite
      DrawObjects
        DrawShots
          (PutSprite)
        DrawItems
          (PutSprite)
        DrawSprites
          (PutSprite)
        DrawEnemies
          (PutSprite)
        DrawPlayer
          (PutSprite)
      DrawScoreboard
        DrawNumber
          (PutTile)
        (PutTile)
      DrawHUD
      DrawPlayerHUD
      DrawMenu
        (PutSprite)
      (SwitchTag)
      (TileType)
      (TileType2)
      (Map)
      (MapFG)
  ShutdownSound
  DeallocXMS
  ClosePAKLib
  ErrorHandlerSub
    DeallocXMS
    (ClosePAKLib)
    (ShutdownSound)

breathe